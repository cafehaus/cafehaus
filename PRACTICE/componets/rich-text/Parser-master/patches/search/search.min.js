module.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.style=t.style||"background-color:yellow";var n={},s=[],a=[];!function e(c,l){for(var i,o=0;i=c[o];o++)if("text"==i.type&&t.key){var h=i.text.split(t.key),r=[];if(h.length>1){for(var d=0;d<h.length;d++)h[d]&&r.push({type:"text",text:h[d]}),d!=h.length-1&&(a.push(l+"["+o+"].children["+r.length+"].attrs.style"),r.push({name:"span",attrs:{id:t.anchor?"search"+a.length:void 0,style:t.style},children:[{type:"text",text:t.key instanceof RegExp?t.key.exec(i.text)[0]:t.key}]}));if(t.key instanceof RegExp&&t.key.exec(i.text),t.anchor)for(var y=s.length;y--&&!s[y].c;)n[s[y].path]=1;n[l+"["+o+"]"]={name:"span",c:t.anchor?1:void 0,s:1,children:r}}}else if(i.s){for(var f,p="",g=0;f=i.children[g];g++)f.text?p+=f.text:p+=f.children[0].text;c[o]={type:"text",text:p},t.key&&(t.key instanceof RegExp?t.key.test(p):p.includes(t.key))?o--:n[l+"["+o+"]"]=c[o]}else i.children&&(s.push({path:l+"["+o+"].c",c:i.c||"table"==i.name}),e(i.children,l+"["+o+"].children"),s.pop())}(e.data.nodes,"nodes"),e.setData(n,function(){t.success&&t.success({num:a.length,highlight:function(n){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"background-color:#FF9632";if(!(n<1||n>a.length)){var c={};this.last&&(c[a[this.last-1]]=t.style),this.last=n,c[a[n-1]]=s,e.setData(c)}},jump:t.anchor?function(t,n){t>0&&t<=a.length&&e.navigateTo({id:"search"+t,offset:n})}:void 0})})}